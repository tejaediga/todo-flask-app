<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>To-Do List</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .strike {
      text-decoration: line-through;
      opacity: 0.6;
    }

    body.dark-mode {
      background-color: #121212;
      color: #ffffff;
    }

    .card.dark-mode {
      background-color: #1f1f1f;
      color: #ffffff;
      border-color: #333;
    }

    .dark-mode .navbar,
    .dark-mode .btn,
    .dark-mode .form-control,
    .dark-mode .form-select {
      background-color: #1f1f1f !important;
      color: #ffffff !important;
      border-color: #444;
    }

    .dark-mode .btn-outline-dark {
      color: #ffffff !important;
      border-color: #ffffff !important;
    }

    .dark-mode .form-control::placeholder {
      color: #aaaaaa;
    }
  </style>
</head>
<body class="p-3">

  <!-- Navbar -->
  <nav class="navbar navbar-dark bg-dark mb-4">
    <div class="container-fluid justify-content-between">
      <span class="navbar-brand">ğŸ“ My To-Do List</span>
      <div>
        <label class="text-white me-2">ğŸŒ™ Dark Mode</label>
        <input type="checkbox" id="toggleDark">
      </div>
    </div>
  </nav>

  <!-- Greeting -->
  <div class="mb-4">
    <h4>Hello, TEJA!ğŸ‘‹</h4>
    <p>Today is <strong>{{ today }}</strong></p>
  </div>

  <!--  Add Task -->
  <form method="POST" action="/add" class="mb-4">
    <div class="row g-2">
      <div class="col-md-7">
        <input type="text" name="task" class="form-control" placeholder="What do you need to do?" required>
      </div>
      <div class="col-md-3">
        <select name="category" class="form-select" required>
          <option value="">Choose Category</option>
          <option value="Study">ğŸ§  Study</option>
          <option value="Meals">ğŸ½ Meals</option>
          <option value="Fitness">ğŸ‹ï¸ Fitness</option>
          <option value="Chores">ğŸ§¹ Chores</option>
          <option value="Sleep">ğŸ˜´ Sleep</option>
        </select>
      </div>
      <div class="col-md-2">
        <button class="btn btn-primary w-100" type="submit">Add</button>
      </div>
    </div>
  </form>

  <!--  Category Filters -->
  <div class="mb-3 d-flex flex-wrap gap-2">
    <a href="/" class="btn btn-outline-primary {{ 'active' if selected_category == 'All' else '' }}">All</a>
    <a href="/?category=Study" class="btn btn-outline-secondary {{ 'active' if selected_category == 'Study' else '' }}">ğŸ§  Study</a>
    <a href="/?category=Meals" class="btn btn-outline-secondary {{ 'active' if selected_category == 'Meals' else '' }}">ğŸ½ Meals</a>
    <a href="/?category=Fitness" class="btn btn-outline-secondary {{ 'active' if selected_category == 'Fitness' else '' }}">ğŸ‹ï¸ Fitness</a>
    <a href="/?category=Chores" class="btn btn-outline-secondary {{ 'active' if selected_category == 'Chores' else '' }}">ğŸ§¹ Chores</a>
    <a href="/?category=Sleep" class="btn btn-outline-secondary {{ 'active' if selected_category == 'Sleep' else '' }}">ğŸ˜´ Sleep</a>
  </div>

  <!--  Status Filters -->
  <div class="mb-4 d-flex gap-2">
    <!--<a href="/?category={{ selected_category }}&filter=all" class="btn btn-outline-dark {{ 'active' if selected_filter == 'all' else '' }}">All</a>-->
    <a href="/?category={{ selected_category }}&filter=pending" class="btn btn-outline-warning {{ 'active' if selected_filter == 'pending' else '' }}">Pending</a>
    <a href="/?category={{ selected_category }}&filter=completed" class="btn btn-outline-success {{ 'active' if selected_filter == 'completed' else '' }}">Completed</a>
  </div>

  <!--  Task Cards -->
  {% for task in tasks %}
  <div class="card mb-2 shadow-sm">
    <div class="card-body d-flex justify-content-between align-items-center {% if task[2] == 1 and selected_filter == 'all' %}strike{% endif %}">
      <div>
        <strong>{{ task[1] }}</strong>
        <span class="badge ms-2
          {% if task[3] == 'Study' %} bg-primary
          {% elif task[3] == 'Meals' %} bg-warning text-dark
          {% elif task[3] == 'Fitness' %} bg-success
          {% elif task[3] == 'Chores' %} bg-info
          {% elif task[3] == 'Sleep' %} bg-secondary
          {% endif %}">
          {{ task[3] }}
        </span>
      </div>
      <div>
        <a href="/complete/{{ task[0] }}" class="btn btn-sm btn-success">âœ”</a>
        <a href="/edit/{{ task[0] }}" class="btn btn-sm btn-warning">âœ</a>
        <a href="/delete/{{ task[0] }}" class="btn btn-sm btn-danger">ğŸ—‘</a>
      </div>
    </div>
  </div>
  {% else %}
  <p class="text-muted">No tasks to show right now...</p>
  {% endfor %}

  <!-- ğŸŒ™ Dark Mode Toggle Script -->
  <script>
    const toggle = document.getElementById("toggleDark");

    // Restore saved dark mode preference
    if (localStorage.getItem("dark-mode") === "on") {
      document.body.classList.add("dark-mode");
      document.querySelectorAll(".card").forEach(card => card.classList.add("dark-mode"));
      toggle.checked = true;
    }

    toggle.addEventListener("change", () => {
      if (toggle.checked) {
        document.body.classList.add("dark-mode");
        document.querySelectorAll(".card").forEach(card => card.classList.add("dark-mode"));
        localStorage.setItem("dark-mode", "on");
      } else {
        document.body.classList.remove("dark-mode");
        document.querySelectorAll(".card").forEach(card => card.classList.remove("dark-mode"));
        localStorage.setItem("dark-mode", "off");
      }
    });
  </script>
</body>
</html>
